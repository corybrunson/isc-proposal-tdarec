# The proposal
<!--
This is where the proposal should be outlined. 
-->

The **goal** of this pilot is to publish or republish 1--3 packages that seamlessly integrate popular techniques from topological data analysis into common statistical workflows in R.
The **expected benefit** is that these extensions will be downloaded and used by researchers and analysts with no specialized background in TDA, which will expose them and their communities to the broader package collection and create sufficient awareness, interest, and demand for users to request features and contribute to the packages.

## Overview
<!--
At a high-level address what your proposal is and how it will address the problem identified. Highlight any benefits to the R Community that follow from solving the problem. This should be your most compelling section.
-->

The Tidymodels package collection[^tidymodels] provides a complete machine learning toolkit for the most common predictive modeling tasks.
Analyses using Tidymodels can be extended to handle less common needs, such as by using time-to-event models through {censored} and customizing performance metrics in {yardstick}.
Machine learning relies heavily on the use of data- and task-appropriate pre-processing steps, especially vectorization methods, and the last decade of work in topological data analysis has produced dozens of promising steps based on persistent homology.
To date, none of these are available to Tidymodels users, and our **primary goal** is to meet that need.
We will accomplish this with an extension to the {recipes} package, which provides pre-processing steps for Tidymodels workflows.

[^tidymodels]: <https://www.tidymodels.org/>

**Pitch {TDAstats} overhaul.**

**Pitch {ripserr} refactorization.**

## Detail
<!--
Go into more detail about the specifics of the project and it delivers against the problem.

Depending on project type the detail section should include:

 - [ ] Minimum Viable Product
 - [ ] Architecture
 - [ ] Assumptions
-->

**Primary goal:**
Publish a {recipes} extension for vectorizations and other transformations based on persistent homology that have been used to pre-process data for machine learning.

Several pre-processing extensions have been published for Tidymodels, including {embed}, {themis}, and {textrecipes}.[^recipes-extensions]
Dr. Brunson has experience writing such an extension, for association rules, which satisfies checks but is not published.[^arulesteps]
The new package would provide `step_*()` functions for several existing topological transformations and invite users to contribute additional steps.

[^arulesteps]: <https://github.com/corybrunson/arulesteps>
[^recipes-extensions]: <https://www.tidyverse.org/blog/2022/05/recipes-update-05-20222/>

Many transformations may eventually be implemented or imported [@Fasy2020; @Pun2022; @Ali2022].
In the list below, following the organizational scheme of @Ali2022, we have boldfaced the transformations we intend to include in a first release. These are selected based on (our impressions of) their relative simplicity, the time since they were first introduced, the frequency with which they are used, and the expected time cost of implementing them or porting an existing implementation.

* Statistical vectorizations
  * **Persistence statistics** [@Ali2022]
  * Entropy summary [@Ali2022]
  * 2D histogram [@Fasy2020]
* Algebraic vectorizations
  * Algebraic functions [@Ali2022]
  * Tropical coordinate functions [@Ali2022]
  * Complex polynomial [@Ali2022]
* Curve vectorizations
  * **Betti curve** [@Fasy2020; @Ali2022]
  * **Lifespan curve** [@Ali2022]
  * **Persistence landscape** [@Fasy2020; @Ali2022]
  * Persistence silhouette [@Ali2022]
* Functional vectorizations
  * Persistence surface [@Pun2022]
  * **Persistence image** [@Fasy2020]
  * Template functions [@Ali2022]

Most selected methods would be implemented anew; the exceptons are persistence landscapes (implemented in {plt}) and persistence images (which would be implemented in a standalone helper package adapted from the original Matlab implementation [^persistence-images]).

[^persistence-images]: <https://github.com/CSU-TDA/PersistenceImages>

**Secondary goal:**
Publish a {flipr} extension for permutation-based statistical inference on topological data.

Several published packages provide statistical inference for persistence diagrams, including {TDAstats}, {TDAkit}, and {TDApplied}.
However, these are _ad hoc_ solutions for specific problems and do not provide a unified, easily extensible framework.
In contrast, Dr. Stamm is co-lead on a coordinated package collection for permutation-based inference, with the published {flipr} package at its center.
An extension for network-valued data, {nevada}[^nevada], is also published.
The new package would specialize tools in {flipr} to types of data arising from TDA.

[^nevada]: <https://cran.r-project.org/package=nevada>

**Aymeric, could you expand on the specific tools this package would provide?**

<!--
Redesign {TDAstats} to specialize in hypothesis tests and better integrate into tidy workflows.

1. Remove Ripser source code and {ggplot2} plotting routines in favor of dependency on {ripserr} and {ggtda}.
2. Identify additional hypothesis tests and null models that should be included [@Robinson2017; @VejdemoJohansson2022].
3. Use standard classes and methods (e.g. class 'htest', method `print()`) to make output follow common R conventions; include {generics} methods like `tidy()`.

The following hypothesis tests are already implemented:

* permutation test for difference in means [@Robinson2017]

The following hypothesis tests may be implemented (listed in order of likely inclusion and feasibility):

* bootstrap sample hypothesis tests [@Blumberg2014]
* Z-test and permutation test for persistence landscapes [@Bubenik2015], currently implemented in {plt}
* exact topological inference [@Chung2017]
* tests for grouped point clouds [@Abdallah2023]
-->

**Tertiary goal:** Refactor {ripserr} with a current implementation of Ripser.

The base implementation of Ripser is written in C++[^ripser], and {ripserr} provides C++/R integration via {Rcpp}.
We therefore anticipate that this update will be a straightforward, though by no means trivial, exercise in C++/R integration via {Rcpp}.

A novel feature that may pose an additional challenge is the recovery of representative cocycles and/or cycles. These features did not exist when {ripserr} was first developed but are essential for many practical applications.
While an ideal interface would pass options to a single C++ function, an simpler approach is available in case this proves impractical, namely to interface to one of multiple C++ functions depending on user specifications.

[^ripser]: <https://github.com/Ripser/ripser>
